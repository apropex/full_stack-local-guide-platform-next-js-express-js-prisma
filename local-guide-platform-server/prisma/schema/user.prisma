model User {
  id          String  @id @default(uuid())
  name        String
  email       String  @unique
  hasPassword Boolean @default(true)
  password    String?
  phone       String?
  gender      Gender?
  address     String?
  bio         String?
  language    String? // Primary language
  country     String? // Country of user
  nationality String?

  status     UserStatus @default(ACTIVE)
  isVerified Boolean    @default(false)
  isDeleted  Boolean    @default(false)

  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())

  avatar         UserAvatar? @relation("UserImage")
  socialImageUrl String?

  // Role-based extension
  role Role @default(TOURIST)

  guide Guide?
  admin Admin?

  bookings Booking[]
  reviews  Review[]
  accounts Account[]

  @@index([email])
}

model Account {
  id                String @id @default(uuid())
  provider          String // "GOOGLE", "GITHUB", "FACEBOOK"
  providerAccountId String // Unique ID given by the provider

  accessToken  String?
  refreshToken String?
  expiresAt    Int?

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())

  @@unique([provider, providerAccountId])
}

model Guide {
  id     String @id @default(uuid())
  userId String @unique

  expertise       String[] // categories like: ["History", "Food"]
  languages       String[] // spoken languages
  about           String?
  experienceYears Int?     @default(0)

  city    String
  country String

  dailyRate  Float
  hourlyRate Float

  isVerifiedGuide  Boolean  @default(false)
  verificationDocs String[]

  dob DateTime
  nid String

  averageRating Float? @default(0)
  totalReviews  Int?   @default(0)

  createdAt DateTime @default(now())

  user  User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  tours Tour[]
}

model Admin {
  id     String @id @default(uuid())
  userId String @unique

  dob DateTime
  nid String

  permissions String[] // Optional: MANAGE_USERS, DELETE_TOURS etc.

  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model UserAvatar {
  id       String  @id @default(uuid())
  url      String
  publicId String  @unique
  format   String?
  width    Int?
  height   Int?
  bytes    Int?
  folder   String?

  createdAt DateTime @default(now())

  userId String @unique
  user   User   @relation("UserImage", fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}
